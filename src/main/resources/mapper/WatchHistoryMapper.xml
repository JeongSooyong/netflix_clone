<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.soo.netflix_clone.model.WatchHistoryDaoImpl">

<!-- watchHistoryResultMap 정의 -->
    <resultMap id="watchHistoryResultMap" type="com.soo.netflix_clone.vo.WatchHistoryVo">
    </resultMap>

<!-- 시청 기록 저장 -->
<insert id="insertWatchHistory" parameterType="com.soo.netflix_clone.vo.WatchHistoryVo">
INSERT INTO netflix.watch_history
    (USER_NO, MOVIE_NO, WATCH_HISTORY_DATE)
    VALUES(#{userNo}, #{movieNo}, CURRENT_TIMESTAMP)
</insert>

<!-- 가장 최근에 시청한 영상 -->
<select id="selectLatestWatchHistory" parameterType="integer">
SELECT USER_NO, MOVIE_NO, WATCH_HISTORY_DATE
	FROM watch_history wh 
  WHERE USER_NO = #{userNo}
	ORDER BY WATCH_HISTORY_DATE DESC 
	LIMIT 1
</select>

</mapper>
